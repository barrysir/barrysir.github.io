"use strict";(self.webpackChunkddr_card_draw=self.webpackChunkddr_card_draw||[]).push([[915],{2145:(e,n,t)=>{t.r(n),t.d(n,{default:()=>G});var s=t(7294),r=t(4511),i=t(8421);const l="drawing__JVp34";var a=t(3180),c=t(6243);const d={headers:"headers__bpI_X",title:"title__RAHea",versus:"versus__qtjCJ",players:"players__eSXWM"};var o=t(451),u=t(3018),h=t(3473),p=t(4889),x=t(5893);const y=(e,n)=>{let{handleClick:t,modifiers:s,query:r,handleFocus:i}=n;if(!s.matchesPredicate)return null;let l=null,a=e;return""===e&&(l="delete",a="No label"),(0,x.jsx)(u.s,{icon:l,active:s.active,disabled:s.disabled,style:{opacity:e?void 0:.5},onClick:t,onFocus:i,text:g(a,r),roleStructure:"listoption"},e)},m=(e,n)=>!e||!!p.Z.isMatch(n,e,!1);function g(e,n){let t=0;const s=n.split(/\s+/).filter((e=>e.length>0)).map(j);if(0===s.length)return[e];const r=new RegExp(s.join("|"),"gi"),i=[];for(;;){const n=r.exec(e);if(!n)break;const s=n[0].length,l=e.slice(t,r.lastIndex-s);l.length>0&&i.push(l),t=r.lastIndex,i.push((0,x.jsx)("strong",{children:n[0]},t))}const l=e.slice(t);return l.length>0&&i.push(l),i}function j(e){return e.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")}var v=t(6839);function f(e){return e}function w(){const{t:e}=(0,v.Y)(),n=(0,c.nl)((e=>e.updateDrawing)),t=(0,c.nl)((e=>e.title)),s=(0,a.Q)((e=>e.tournamentRounds));return(0,x.jsx)(_,{size:"medium",placeholder:e("tournamentRoundPlaceholder"),itemList:s,value:t||null,onSelect:e=>n({title:e})})}function _(e){const{t:n}=(0,v.Y)(),t=(0,s.useMemo)((()=>{const n=e.itemList.slice();return e.noEmpty||n.unshift(""),n}),[e.itemList,e.noEmpty]);return(0,x.jsx)(h.U,{inputProps:{style:{boxShadow:"none",textAlign:"center",background:"transparent",height:"36px",lineHeight:"36px",fontSize:"medium"===e.size?"26px":"32px"},placeholder:e.placeholder},className:o.ZA5,items:t,resetOnSelect:!0,resetOnClose:!0,createNewItemPosition:"first",createNewItemFromQuery:f,inputValueRenderer:f,createNewItemRenderer:(e,t,s)=>(0,x.jsx)(u.s,{active:t,onClick:s,text:n("tournamentRoundAdd",{round:e}),icon:"add",roleStructure:"listoption"},e),itemPredicate:m,itemRenderer:y,noResults:(0,x.jsx)(u.s,{disabled:!0,text:n("noResults"),roleStructure:"listoption"}),onItemSelect:e.onSelect,selectedItem:e.value||null})}var b=t(8095),P=t(7391);function k(){const e=(0,a.Q)((e=>e.showPlayerAndRoundLabels)),n=(0,c.nl)((e=>e.players));return e?(0,x.jsxs)("div",{className:d.headers,children:[(0,x.jsx)("div",{className:d.title,children:(0,x.jsx)(w,{})}),(0,x.jsx)("div",{className:d.players,children:n.map(((e,n)=>(0,x.jsx)(S,{placeholder:"Player ".concat(n+1),playerIndex:n+1},n)))})]}):null}function C(){const e=(0,c.nl)((e=>e.players)),n=(0,c.nl)((e=>e.incrementPriorityPlayer)),t=(0,c.nl)((e=>e.priorityPlayer));return 2!==e.length?null:(0,x.jsxs)("div",{className:d.versus,onClick:n,children:[(0,x.jsx)(b.I,{icon:P.d.CaretLeft,style:{visibility:1===t?"visible":"hidden",verticalAlign:"middle"}})," vs ",(0,x.jsx)(b.I,{icon:P.d.CaretRight,style:{visibility:2===t?"visible":"hidden",verticalAlign:"middle"}})]})}function S(e){let{playerIndex:n,placeholder:t}=e;const r=(0,c.nl)((e=>e.updateDrawing)),i=(0,c.nl)((e=>e.players[n-1]||null)),l=(0,a.Q)((e=>e.playerNames)),d=(0,a.Q)((e=>e.update)),o=(0,s.useCallback)((e=>{r((t=>{const s=t.players.slice();return s[n-1]=e,{players:s}})),l.includes(e)||d((n=>{const t=n.playerNames.slice();return t.push(e),{playerNames:t}}))}),[r,n,l,d]),u=(0,x.jsx)(_,{value:i,itemList:l,placeholder:t,onSelect:o,size:"large"});return 1===n?(0,x.jsxs)(x.Fragment,{children:[u,(0,x.jsx)(C,{})]}):u}var I=t(2771),N=t(8699),R=t(3233),z=t(1963);var A=t(5894),M=t(1871),L=t(6175),E=t(2912),B=t(6130);function D(){const e=(0,c.nl)((e=>e.serializeSyncFields)),n=(0,c.nl)((e=>e.updateDrawing)),t=(0,c.nl)((e=>e.redrawAllCharts)),s=(0,c.nl)((e=>!!e.players.length)),i=(0,c.nl)((e=>e.__syncPeer)),l=(0,M.n)((e=>!!e.thisPeer)),d=(0,M.n)((e=>e.remotePeers)),o=(0,M.n)((e=>e.sendDrawing)),h=(0,M.n)((e=>e.beginSyncWithPeer)),p=(0,c.oM)(),y=(0,a.Q)((e=>e.showPlayerAndRoundLabels)),{showBoundary:m}=(0,r.cO)();let g;const j=(0,B.Hw)(d.values());if(1===d.size&&j){const n=(0,M.G)(j.peer);g=(0,x.jsxs)(I.v,{children:[(0,x.jsx)(u.s,{icon:P.d.SendMessage,text:"Send to ".concat(n),onClick:()=>o(e())}),(0,x.jsx)(u.s,{icon:P.d.Changes,text:"Start sync with ".concat(n),onClick:()=>h(p)})]})}else d.size>1&&(g=(0,x.jsxs)(I.v,{children:[(0,x.jsx)(u.s,{icon:P.d.SendMessage,text:"Send to...",children:(0,x.jsx)(A.n,{disabled:!!i&&[i.peer],onClickPeer:n=>o(e(),n)})}),(0,x.jsx)(u.s,{icon:P.d.Changes,text:"Start sync with...",children:(0,x.jsx)(A.n,{disabled:!!i&&[i.peer],onClickPeer:e=>h(p,e)})})]}));const v=(0,x.jsx)(N.z,{minimal:!0,text:(0,x.jsx)(b.I,{icon:P.d.Share}),disabled:!d.size});return(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)("div",{className:"networkButtons__bf3hc",children:[i&&(0,x.jsx)(b.I,{icon:P.d.Changes,intent:"success"}),l?d.size?(0,x.jsx)(R.J,{content:g,children:v}):(0,x.jsx)(z.u,{content:"Connect to a peer to share",children:v}):null,(0,x.jsx)(z.u,{content:"Save Image",children:(0,x.jsx)(N.z,{minimal:!0,icon:P.d.Camera,onClick:async()=>{const n=e().id,t=document.querySelector("#drawing-"+n);t&&(0,E.Gy)(await(0,L.jN)(t,{scale:2}),"card-draw.png")}})}),(0,x.jsx)(z.u,{content:"Redraw all charts",children:(0,x.jsx)(N.z,{minimal:!0,icon:P.d.Refresh,onClick:()=>confirm("This will replace everything besides protects and pocket picks!")&&t()})}),null,y&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(z.u,{content:"Add Player",children:(0,x.jsx)(N.z,{minimal:!0,icon:P.d.NewPerson,onClick:()=>{n((e=>{const n=e.players.slice();return n.push(""),{players:n}}))}})}),(0,x.jsx)(z.u,{content:"Remove Player",disabled:!s,children:(0,x.jsx)(N.z,{minimal:!0,icon:P.d.BlockedPerson,disabled:!s,onClick:()=>{n((e=>{const n=e.players.slice();return n.pop(),{players:n}}))}})})]})]})})}var F=t(3007);function H(){const e=(0,c.nl)(),n=(0,c.oM)(),t=(0,M.n)((n=>{if(e.__syncPeer)return n.remotePeers.get(e.__syncPeer.peer)}));return(0,s.useEffect)((()=>{!t&&e.__syncPeer&&e.updateDrawing({__syncPeer:void 0})}),[e,t]),(0,s.useEffect)((()=>{if(e.__syncPeer)return(0,F.BJ)(n,e.__syncPeer)}),[e.__syncPeer,n]),null}var Q=t(6363),J=t(7828),q=t(7527);let O=Math.floor(255*Math.random());function V(){const e=(0,c.nl)((e=>e.charts));return(0,x.jsx)(J.M,{children:(0,x.jsx)(q.E.div,{className:"chartList__HNAHU",variants:{hidden:{opacity:0,scale:.8,transition:{type:"spring",bounce:.4,staggerChildren:.02,staggerDirection:-1}},show:{opacity:1,scale:1,transition:{type:"spring",bounce:.4,staggerChildren:.3}}},initial:"hidden",animate:"show",children:e.map((e=>(0,x.jsx)(W,{chartId:e.id},e.id)))})})}function W(e){let{chartId:n}=e;const t=(0,c.nl)((e=>e.charts.find((e=>e.id===n)))),s=(0,c.nl)((e=>e.bans.find((e=>e.chartId===n)))),r=(0,c.nl)((e=>e.protects.find((e=>e.chartId===n)))),l=(0,c.nl)((e=>e.pocketPicks.find((e=>e.chartId===n)))),a=(0,c.nl)((e=>e.winners.find((e=>e.chartId===n))));return t?(0,x.jsx)(q.E.div,{layout:!0,style:{display:"flex",flex:"1 0 0"},variants:{hidden:{opacity:0,scale:.8,transition:{type:"spring",bounce:.4}},show:{opacity:1,scale:1,transition:{type:"spring",bounce:.4}}},children:(0,x.jsx)(i.P,{vetoedBy:null==s?void 0:s.player,protectedBy:null==r?void 0:r.player,replacedBy:null==l?void 0:l.player,replacedWith:null==l?void 0:l.pick,winner:null==a?void 0:a.player,chart:t,actionsEnabled:!0})}):null}function X(){return(0,a.Q)((e=>e.showPlayerAndRoundLabels))?null:(0,x.jsx)("div",{style:{height:"15px"}})}const G=(0,s.memo)((function(e){let{drawing:n}=e;const[t]=(0,s.useState)((O+=95.625,"linear-gradient(hsl(".concat(O,", var(--drawing-grad-saturation), var(--drawing-grad-lightness)), transparent, transparent)")));return(0,x.jsx)(c.X_,{initialDrawing:n,children:(0,x.jsxs)(r.SV,{fallback:(0,x.jsx)("div",{className:l,style:{backgroundImage:t,padding:"2em",minHeight:"15em",display:"flex",justifyContent:"center"},children:(0,x.jsx)(Q.H,{})}),children:[(0,x.jsx)(H,{}),(0,x.jsxs)("div",{style:{backgroundImage:t},className:l,children:[(0,x.jsx)(X,{}),(0,x.jsxs)("div",{id:"drawing-".concat(n.id),children:[(0,x.jsx)(k,{}),(0,x.jsx)(V,{})]}),(0,x.jsx)(D,{})]},n.id)]})})}))}}]);
//# sourceMappingURL=915.0e626.js.map