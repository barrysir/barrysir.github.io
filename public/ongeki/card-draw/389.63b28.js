"use strict";(self.webpackChunkddr_card_draw=self.webpackChunkddr_card_draw||[]).push([[389],{4850:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Z});var a=n(8712),s=n(3180),r=n(4538),l=n(8421),o=n(9486),i=n(8673),c=n(9712),d=n(113),u=n(6250),f=n(1548),x=n(8583),m=n(7294),h=n(4992),g=n(3740),j=n(9740),p=n(5725),v=n(592),y=n(7891),b=n(3466),k=n(6130),w=n(6839),D=n(3531),C=n(2402),S=n(5893);function A(e){let{charts:t}=e;const{t:n}=(0,w.Y)(),a=(0,C.Fg)()===C.Q2.Dark?"white":void 0,s=(0,f.Mv)(),l=(0,r.g)((e=>{var t;return null===(t=e.gameData)||void 0===t?void 0:t.meta.difficulties})),[o,i,c,d]=(0,m.useMemo)((()=>{const e={};let a=0;const s=new k.Tx;for(const n of t)e[n.diffAbbr]||(e[n.diffAbbr]=new k.Tx),e[n.diffAbbr].add(n.level),a=Math.max(a,s.add(n.level));const r=Array.from(s.values()).sort(((e,t)=>e-t)),o=(l||[]).filter((t=>!!e[(0,D.b1)(n,t.key)])).reverse();return[o.map((t=>({color:t.color,key:t.key,label:(0,D.zj)(n,t.key),data:r.map((a=>({level:(0,D.aI)(a),count:e[(0,D.b1)(n,t.key)].get(a)||0})))}))),o.map((e=>e.color)),Array.from(s.values()).sort(((e,t)=>e-t)).map((e=>(0,D.aI)(e))),Array.from(s.valuesWithCount()).sort(((e,t)=>e[0]-t[0])).map((e=>{let[,t]=e;return t}))]}),[l,t,n]);return(0,S.jsxs)(g.k,{domainPadding:{x:2===d.length?250:50},style:{parent:{height:s?"200px":"300px",touchAction:"auto"}},width:s?600:800,children:[(0,S.jsx)(j.N,{colorScale:i,labels:d,labelComponent:(0,S.jsx)(p.X,{}),children:o.map((e=>(0,S.jsx)(v.Z,{data:e.data,labels:e.data.map((t=>"".concat(t.count," ").concat(e.label," charts"))),style:{labels:{fill:a}},x:"level",y:"count",labelComponent:(0,S.jsx)(y.Z,{})},e.key)))}),(0,S.jsx)(b.E,{tickValues:c,label:"Chart Level",style:{axis:{stroke:a},tickLabels:{fill:a},axisLabel:{fill:a}}})]})}var E=n(8699),O=n(1823),R=n(8799),F=n(9685),M=n(3640),G=n(5103);const V=(0,G.cn)(!1),z=(0,G.cn)(0),K=(0,G.cn)(void 0),L=1e4,P=L/100;var Q=n(7610);function _(e){return e.name.startsWith('DEAD END("GROOVE')}function I(){return new Promise((e=>{requestIdleCallback(e)}))}function N(){const[e,t]=(0,x.KO)(V),[n,l]=(0,x.KO)(z),[o,i]=(0,x.KO)(K),c="number"==typeof o;return(0,S.jsxs)(S.Fragment,{children:[!e&&(0,S.jsxs)(E.z,{onClick:async function(){t(!0),l(0),i(void 0),await I();const e=function*(){let e=0;for(const[t,n]of function*(){const e=r.g.getState().gameData,t=s.Q.getState();for(let n=0;n<L;n++)yield[(0,a.ii)(e,t),n]}())t.charts.some(_)&&e++,n%P==0&&(yield n/L);return e/L}();let n=e.next();for(;!n.done;)l(n.value),await I(),n=e.next();t(!1),l(100),i(n.value)},intent:"danger",icon:c?"repeat":"warning-sign",children:[c?"Recompute":"Compute"," DEGRS Forecast"]}),e&&(0,S.jsxs)("p",{children:["Calculating DEGRS ratio..."," ",(0,S.jsx)(O.k,{value:n,intent:"danger"})]}),c&&(0,S.jsxs)(R.U,{icon:"rain",children:["Today's risk of DEGRS is ",(100*o).toFixed(1),"%"]})]})}function T(e){const[t,n]=(0,m.useState)(!1);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(F.V,{isOpen:t,onClose:()=>n(!1),title:"DEGRS Emergency Response System",icon:"warning-sign",children:(0,S.jsx)(M.a,{children:(0,S.jsx)(N,{})})}),(0,S.jsx)(Q.P,{...e,onClick:()=>n(!0)})]})}function Z(){const e=(0,r.g)((e=>e.gameData)),[t]=(0,m.useDeferredValue)((0,x.KO)(h.e)),n=(0,m.useDeferredValue)((0,s.Q)()),g=(0,f.Mv)(),j="all"!==t,p=(0,m.useMemo)((()=>e?Array.from((0,a.Qm)(n,e)):[]),[e,n]),[v,y]=(0,m.useMemo)((()=>{const e=new Set,n=p.filter((n=>(e.add(function(e){return"".concat(e.name,":").concat(e.artist)}(n)),!j||!n.flags.every((e=>e!==t)))));return[e,n]}),[p,j,t]);return e?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(c.w,{style:{position:"sticky",top:"50px"},children:[(0,S.jsxs)(d.f,{children:[p.length," eligible charts from ",v.size," songs (of"," ",e.songs.length," total)"]}),n.flags.size>0&&!g&&(0,S.jsxs)(d.f,{children:[(0,S.jsx)(u.o,{}),(0,S.jsx)(h.d,{})]})]}),(0,S.jsx)(A,{charts:y}),(0,S.jsx)("div",{className:o.Z.chartList,children:y.map(((e,t)=>_(e)?(0,S.jsx)(T,{chart:e},t):(0,S.jsx)(l.P,{chart:e},t)))})]}):(0,S.jsx)(i.$,{})}}}]);
//# sourceMappingURL=389.63b28.js.map